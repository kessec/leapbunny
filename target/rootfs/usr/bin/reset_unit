#!/bin/sh

# This file will clear all user profiles and logs from unit only.   


# Ensure we booted from the Base NAND, not the ATAP
if [ `grep lf1000-nor /proc/iomem | cut -d '-' -f 1` = "84000000" ]; then
	if [ `cat /sys/devices/platform/lf1000-gpio/board_id` != 3 ]; then
		ATAP=1
		echo "Unable to run this script when booted from the ATAP.  Must boot from the Device NAND"
		echo "Cannot do this while booted from ATAP." > /tmp/ResetUnitResult
		exit 1
	fi
fi

echo "Removing any flight recorder logs & core dumps"
rm -f /LF/Base/FR/*
logger -s -t "Emerald App" -p local4.notice "reset_unit has cleared flight recorder log and core dumps"

echo "This will clear all profiles and logs".
rm -rf /LF/Bulk/Data/Shared/0/*
rm -rf /LF/Bulk/Data/Shared/1/*
rm -rf /LF/Bulk/Data/Shared/2/*
rm -rf /LF/Bulk/Data/Shared/All/*
rm -f /LF/Base/settings.cfg
rm -f /flags/no8sec
rm -f /flags/main_app
rm -f /flags/pointercal
rm -f /flags/volume
rm -f /flags/console_out
rm -f /flags/poweron
rm -f /flags/fps

logger -s -t "Emerald App" -p local4.notice "reset_unit has cleared the profiles and settings"

echo "Unit RESET DONE" > /tmp/ResetUnitResult
exit 0
